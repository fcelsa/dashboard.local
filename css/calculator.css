/* Calcolatrice stile Olivetti Logos 182 PD Inspired */

.calculator-wrapper {
    display: grid;
    grid-template-columns: 1fr 360px; /* Corpo | Right Panel (Carta) */
    grid-template-rows: 1fr auto;
    gap: 20px;
    height: 100%;
    align-items: start;
    font-family: "Inter", sans-serif;
}

/* --- Lato Destro: Paper --- */
.calc-right-panel {
    display: flex;
    flex-direction: column;
    gap: 12px;
    flex-grow: 1;
}

/* --- Lato Sinistro: Macchina --- */
.calc-body {
    background: var(--calc-bg, #556887);
    border-radius: 8px;
    padding: 24px;
    box-shadow: 
        inset 0 1px 0 rgba(255,255,255,0.5),
        0 20px 50px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    gap: 8px;
    position: relative;
    border-bottom: 8px solid var(--calc-border, #343e4e);
}

/* Focus LED */
.focus-led {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background-color: var(--led-off, #300);
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.5);
    position: absolute;
    top: 15px; 
    left: 32px;
    transition: background-color 0.2s, box-shadow 0.2s;
    border: 1px solid #222;
}

/* Accensione LED su Hover o Focus */
.calculator-wrapper:hover .focus-led,
.calculator-wrapper:focus-within .focus-led {
    background-color: var(--led-on, #ff3300);
    box-shadow: 0 0 5px var(--led-on, #ff3300), inset 0 1px 1px rgba(255,255,255,0.3);
}

/* Display VFD */
.vfd-display {
    background: var(--vfd-bg, #0d1110);
    padding: 10px 15px;
    border-radius: 4px;
    border: 4px solid var(--calc-border, #343e4e);
    box-shadow: inset 0 0 15px rgba(0,0,0,0.9);
    height: 75px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    overflow: hidden;
    margin-bottom: 12px;
    margin-top: 10px;
    position: relative;
    z-index: 10;
    transition: background 0.2s ease, box-shadow 0.2s ease;
}

.vfd-display.is-off {
    background: var(--vfd-bg-off, #070a0a);
    box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.95);
}

.vfd-display.is-off .vfd-text,
.vfd-display.is-off .vfd-stack,
.vfd-display.is-off .vfd-status-icons {
    opacity: 0;
    transition: opacity 0.25s ease;
}

.vfd-text,
.vfd-stack,
.vfd-status-icons {
    transition: opacity 0.25s ease;
}

.vfd-display.is-blink .vfd-text,
.vfd-display.is-blink .vfd-stack,
.vfd-display.is-blink .vfd-status-icons {
    animation: vfdBlink 0.8s steps(2, start) infinite;
}

.vfd-icon.blink {
    animation: vfdBlink 0.8s steps(2, start) infinite;
}

@keyframes vfdBlink {
    0%, 49% { opacity: 1; }
    50%, 100% { opacity: 0; }
}

.vfd-text {
    flex-grow: 1;
    text-align: right;
    font-family: "Droid Sans Mono", monospace;
    font-size: 2.1rem;
    color: var(--vfd-text, #00ffaa);
    text-shadow: 0 0 8px var(--vfd-accent, rgba(0, 255, 170, 0.5));
    letter-spacing: 0.1em;
    margin: 0 10px;
}

.vfd-stack {
    position: absolute;
    left: 42px;
    right: 14px;
    bottom: 6px;
    font-family: "Droid Sans Mono", monospace;
    font-size: 0.55rem;
    color: var(--vfd-text-dim, rgba(0, 255, 170, 0.7));
    letter-spacing: 0.05em;
    text-align: left;
    pointer-events: none;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Status Icons VFD */
.vfd-status-icons {
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-family: sans-serif;
    font-size: 0.7rem;
    color: var(--vfd-status-off, #004433);
}
.vfd-icon-row {
    display: flex;
    align-items: center;
    gap: 4px;
}
.vfd-icon-value {
    font-family: "Droid Sans Mono", monospace;
    font-size: 0.55rem;
    color: var(--vfd-text-dim, rgba(0, 255, 170, 0.7));
    letter-spacing: 0.05em;
}
.vfd-icon {
    font-weight: bold;
    text-transform: uppercase;
}
.vfd-indicator-soft {
    font-family: "Droid Sans Mono", monospace;
    font-size: 0.65rem;
    color: var(--vfd-text-dim, rgba(0, 255, 170, 0.6));
    letter-spacing: 0.05em;
    min-height: 0.7rem;
}
.vfd-icon.on {
    color: var(--led-on, #ff3300);
    text-shadow: 0 0 5px var(--led-glow, rgba(255, 50, 0, 0.8));
}
.vfd-icon.off {
    opacity: 0.3;
}

.vfd-icon.mem-pending {
    animation: memPulse 0.8s ease-in-out infinite;
}

@keyframes memPulse {
    0%, 100% {
        opacity: 0.25;
    }
    50% {
        opacity: 1;
    }
}


/* --- SWITCHES ROW --- */
.calc-switches {
    display: flex;
    justify-content: space-between; /* Distribuisce uniformemente nella larghezza */
    align-items: flex-start; /* Allinea in alto per allineare etichette e slider */
    gap: 10px;
    margin-bottom: 10px; /* Ridotto per avvicinare alla tastiera */
    padding: 0 5px; /* Margini laterali minimi */
}

.switch-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    position: relative;
}

.switch-label {
    font-size: 0.7rem;
    font-weight: 700;
    color: var(--switch-label, #888);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 2px;
}

/* Switch Multi-Posizione (Slider) */
/* .multi-switch { } Rimosso regola vuota */
.ro-switch { width: 60px; }  /* 3 posizioni */
.dec-switch { width: 120px; } /* 6 posizioni */

/* Ticks Label (Stile etichette 0 5 9 ecc) */
.switch-ticks {
    display: flex;
    justify-content: space-between;
    width: 100%;
    padding: 0 2px;
    margin-top: 2px; /* Piccola distanza dallo slider */
}
.switch-ticks span {
    font-size: 0.65rem;
    font-family: sans-serif;
    color: var(--switch-ticks, #bbb);
    font-weight: 600;
    width: 10px;
    text-align: center;
}

/* INPUT RANGE Custom Styling */
input[type=range].switch-slider {
    -webkit-appearance: none; /* Rimuove styling default browser */
    appearance: none;         /* Standard property */
    width: 100%;
    background: transparent;
    margin: 0;
    cursor: pointer;
}

/* Traccia dello Slider */
input[type=range].switch-slider::-webkit-slider-runnable-track {
    width: 100%;
    height: 16px;
    cursor: pointer;
    background: var(--switch-track, #222);
    border-radius: 2px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.6);
}

/* Pomello (Thumb) dello Slider */
input[type=range].switch-slider::-webkit-slider-thumb {
    height: 12px;
    width: 12px;
    border-radius: 1px;
    background: var(--switch-thumb, #e0e0dc);
    cursor: pointer;
    -webkit-appearance: none;
    margin-top: 2px;
    box-shadow: 
        0 1px 2px rgba(0,0,0,0.5),
        inset 0 1px 0 rgba(255,255,255,0.8);
}

/* Switch Toggle Styling (Slide puro per ACC/PRT) */
.switch {
    position: relative;
    display: inline-block;
    width: 32px; /* Larghezza fissa per i 2 stati */
    height: 16px;
}
/* ... resto invariato per input e slider del checkbox ... */
.switch input { 
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: var(--switch-track, #222);
    transition: .2s;
    border-radius: 2px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.5);
}

.slider:before {
    position: absolute;
    content: "";
    height: 12px;
    width: 12px;
    left: 2px;
    bottom: 2px;
    background-color: var(--switch-thumb, #e0e0dc);
    box-shadow: 0 1px 1px rgba(0,0,0,0.5);
    transition: .2s;
    border-radius: 1px;
}

input:checked + .slider {
    background-color: #222; 
}

input:checked + .slider:before {
    transform: translateX(16px);
    background-color: var(--switch-thumb, #e0e0dc);
}


/* Container Tastiera */
.calc-keyboard-container {
    display: flex;
    flex-direction: column;
    gap: 24px;
    padding: 15px;
    background: var(--calc-panel, #333333);
    border-radius: 8px;
    box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
}

.calc-func-keys {
    display: flex;
    justify-content: space-between;
    width: 596px; /* Allineato esattamente alla larghezza dei tasti principali */
    margin: 0 auto; /* Centrato nel container */
}

.calc-main-keys {
    display: flex;
    gap: 20px;
    justify-content: center;
}

/* BLOCCHI TASTI */
.key-block {
    display: grid;
    gap: 8px;
}

/* Blocco 1: Sinistra (2 colonne x 4 righe) */
.block-left {
    grid-template-columns: repeat(2, 50px);
    grid-template-rows: repeat(4, 50px);
    grid-auto-flow: column; /* Importante per l'ordine verticale */
}

/* Blocco 2: Centrale (Numerico - 4 colonne x 4 righe) */
.block-center {
    grid-template-columns: repeat(4, 50px);
    grid-template-rows: repeat(4, 50px);
}

/* Blocco 3: Destra (Totali) */
.block-right {
    display: grid;
    grid-template-columns: repeat(4, 50px);
    grid-template-rows: 50px auto;
    gap: 8px; 
}

/* Struttura interna parte bassa blocco destro */
.block-right-lower {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: 108px 1fr; /* Tasto + largo 2 colonne + gap */
    gap: 8px;
}

.block-right-side-cols {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: repeat(3, 50px);
    grid-auto-flow: column;
    gap: 8px;
}

/* --- STILI TASTI --- */
.key-btn {
    border: none;
    font-family: "Inter", sans-serif;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    position: relative;
    box-shadow: 
        0 4px 0 rgba(0,0,0,0.3),
        0 5px 8px rgba(0,0,0,0.2);
    transition: transform 0.05s, box-shadow 0.05s;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1;
}

.key-btn:active, .key-btn.active {
    transform: translateY(4px);
    box-shadow: none;
}

/* Pseudo-elemento per il "Tasto Fisico" sopra la base */
.key-btn::after {
    content: attr(data-key);
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.2), 
        0 2px 4px rgba(0,0,0,0.3); /* Ombra del tasto sulla base */
    z-index: 2;
}

/* --- TASTI RETTANGOLARI cost sell margin tax+ tax- rate --- */
.key-rect {
    width: 56px; 
    height: 30px;
    border-radius: 4px;
    background: var(--key-bg-default, #2b3036);
    color: var(--key-text-light, #eee);
    font-size: 0.68rem;
}
.key-rect::after {
    width: 50px; /* Adattato al nuovo width */
    height: 22px; /* Adattato al nuovo height */
    border-radius: 3px;
    /* Il colore viene definito da key-gray */
}

/* --- TASTI ROTONDI (Blocco Centrale) --- */
.key-round {
    background-color: var(--key-bg-default, #e6e4d5);
    border-radius: 4px;
    color: transparent;
}

.key-round::after {
    width: 36px; height: 36px;
    background: var(--key-bg-numeric, #383e45);
    border-radius: 50%;
    color: var(--key-text-light, #e6e4d5);
    font-size: 1.1rem;
}

/* Tasto 0 Doppio: Base larga, tasto fisico largo "pillola" */
.key-round.key-double-h {
    grid-column: span 2;
    background-color: var(--key-bg-default, #e6e4d5);
}
.key-round.key-double-h::after {
    width: 86px;               /* Più largo */
    border-radius: 18px;       /* Pillola */
}


/* --- TASTI QUADRATI (Blocchi Laterali) --- */
/* Stesso concetto del round: Base + Tasto sopra, ma tasto è quadrato */

.key-square {
    border-radius: 4px;        /* Base Quadrata */
    color: transparent;        /* Nascondi testo base */
}

.key-square::after {
    width: 36px; height: 36px; /* Dimensioni tasto fisico quadrato */
    border-radius: 6px;        /* Angoli leggermente smussati */
    font-size: 1.1rem;
}

/* Doppio Verticale */
.key-square.key-double-v {
    grid-row: span 2;
    height: 100%;
}
.key-square.key-double-v::after {
    height: 94px; /* Altezza doppia (50+50-gap/padding) aggiustata */
}
/* Doppio Orizzontale */
.key-square.key-double-h {
    grid-column: span 2;
    width: 100%;
}
.key-square.key-double-h::after {
    width: 94px;
}
/* Gigante + : 3 righe x 2 colonne verticalmente ~ 210px? 
   Grid rows 50px * 3 + gap 8px * 2 = 150 + 16 = 166px in altezza
   Grid cols 50px * 2 + gap 8px = 108px in larghezza
   Aspetta, il blocco lower è definito "108px 1fr". Tasto + occupa col 1.
   Key-plus-large deve avere tasto fisico che copre quest'area.
*/
.key-square.key-plus-large {
    height: 100%; /* Gestito dalla griglia */
    width: 100%;
}
.key-square.key-plus-large::after {
    width: 94px;   /* 50 + 50 - margini */
    height: 154px; /* 3 righe (50*3 + 2 gaps) - padding. 166 - un po' */
}


/* --- COLORI SPECIFICI TASTI QUADRATI --- */

/* Blocco SX: Azzurro */
.key-cyan {
    background-color: var(--key-bg-cyan, #5f8a9e);
}
.key-cyan::after {
    background-color: var(--key-bg-numeric, #383e45);
    color: var(--key-text-cyan, #89cff0);
}

/* Blocco DX: Verde Scuro (Tasto T, S, ecc) */
.key-green {
    background-color: var(--key-bg-green, #5d7a72);
}
.key-green::after {
    background-color: var(--key-bg-numeric, #383e45);
    color: var(--key-text-light, #e6e4d5);
}
/* Correzione richiesta: "il colore del testo è uguale a quello della parte di sfondo" -> Sfondo del tasto o sfondo della base? 
   Se intendi "testo colore verde", ok. Se intendi "colore crema", ok.
   Dalle foto Logos 182, i tasti verdi hanno testo bianco. I tasti chiari hanno testo verde scuro.
   "Escluso i tasti del secondo totalizzatore che hanno un colore verdi più chiaro... ed il colore del testo è uguale a quello della parte di sfondo" -> Forse intendevi "colore testo uguale a quello dello sfondo (scuro)"?
   Provo: Tasti scuri -> Testo Bianco. Tasti Chiari -> Testo Verde Scuro.
*/


/* Blocco DX: Verde Chiaro (T2, S2, op2) */
.key-light-green {
    background-color: var(--key-bg-light-green, #8da39f);
}
.key-light-green::after {
    background-color: var(--key-bg-numeric, #383e45);
    color: var(--key-text-light, #e6e4d5);
}

/* --- OVERRIDES SPECIFICI PER TASTI --- */

/* Tasto Meno: Rosso e Grande */
button[data-key="-"]::after {
    color: var(--key-minus-color, #b74040);
    font-size: 1.5rem;
}

/* Tasto Più: Grande */
button[data-key="+"]::after {
    font-size: 1.5rem;
}

/* Tasto CNT: Font piccolo */
button[data-key="CNT"]::after {
    font-size: 0.7rem;
    font-weight: 600;
}

/* Tasti Funzione Rettangolari (Grigi) */
.key-gray {
    background-color: var(--key-bg-gray, #4a4a4a);
}
.key-gray::after {
    background-color: var(--key-bg-gray-thumb, #b0b0b0);
    color: var(--key-text-dark, #111);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.5);
}


/* Carta */
.paper-container {
    background: var(--paper-bg, #556887);
    box-shadow: 
        inset 0 10px 20px rgba(0,0,0,0.5),
        0 5px 15px rgba(0,0,0,0.3);
    height: 600px;
    overflow: hidden;
    position: relative;
    border-radius: 4px;
    padding: 6px;
}

/* Rotolo di carta */
.paper-tape {
    background-color: var(--paper-tape-bg, #fdfae7);
    background-image: 
        linear-gradient(90deg, rgba(0,0,0,0.06) 0%, rgba(0,0,0,0) 5%, rgba(0,0,0,0) 95%, rgba(0,0,0,0.06) 100%),
        url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.15'/%3E%3C/svg%3E");
    color: var(--paper-ink, #2a2a2a);
    
    font-family: "Courier Prime", "Courier New", monospace;
    font-size: 1.1rem;
    font-weight: 600;
    line-height: 1.5;
    
    height: 100%;
    overflow-y: scroll; /* Scrollbar sempre visibile per evitare "salto" layout */
    display: flex;
    flex-direction: column;
    
    padding: 16px 8px;
    box-shadow: 
        0 0 5px rgba(0,0,0,0.2), /* Ombra esterna leggera */
        inset 0 0 40px rgba(139, 137, 110, 0.15); /* Ombra interna ingiallita */
        
    /* Simulazione bordi strappati o irregolari non facile in pure CSS senza immagini mask, 
       ma possiamo dare un effetto di carta spessa */
    /* transform: perspective(1000px) rotateX(2deg); RIMOSSO per evitare conflitti con scroll/pointer events */
    /* transform-origin: top center; */
}

/* Scrollbar styling per WebKit (Chrome, Safari) - opzionale per integrarla meglio */
.paper-tape::-webkit-scrollbar {
    width: 10px;
}
.paper-tape::-webkit-scrollbar-track {
    background: var(--scrollbar-track-bg, rgba(0,0,0,0.05));
    border-radius: 4px;
}
.paper-tape::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb-bg, rgba(0,0,0,0.2)); 
    border-radius: 4px;
}
.paper-tape::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover-bg, rgba(0,0,0,0.3));
}

/* Fix per allineamento in basso che non rompe lo scroll: 
   Il primo elemento spinge giù tutto il contenuto. 
   Quando c'è overflow, margin-top collassa e lo scroll funziona. */
.paper-tape > :first-child {
    margin-top: auto;
}

.tape-row {
    display: flex;
    justify-content: flex-end; /* Allinea tutto a destra di base */
    border-bottom: none; /* Removed dashed line */
    padding: 0; /* Removed padding */
    text-shadow: 1px 1px 2px rgba(42, 42, 42, 0.15); 
    width: 100%;
    line-height: 1.1; /* Compact line height */
}

.tape-symbol {
    color: var(--tape-symbol-color, #444);
    font-weight: 700;
    min-width: 25px; /* Spazio fisso per il simbolo */
    text-align: right;
    margin-left: 4px; /* Reduced separation */
}

.tape-symbol.tape-symbol-small {
    font-size: 0.8em;
    min-width: 18px;
}
.tape-val {
    letter-spacing: 0.5px; /* Reduced letter spacing */
    text-align: right;
}

/* Ensure for right-aligned rows the numeric value expands and stays flush right
   while the symbol remains to the immediate right without forcing extra space. */
.tape-row.align-right .tape-val {
    flex: 1 1 auto;
    text-align: right;
    min-width: 0; /* allow shrinking in narrow containers */
}
.tape-row .tape-symbol {
    flex: 0 0 auto;
    margin-left: 8px;
    white-space: nowrap;
}

.tape-percent {
    margin-left: 6px;
    color: var(--tape-percent-color, #9a9a9a);
    font-weight: 600;
    font-size: 0.85em;
}

/* Modifiche per specifiche layout */
.tape-row.align-left {
    justify-content: flex-start; /* Moltiplicazioni/Divisioni a sinistra */
}
.tape-row.align-right {
    justify-content: flex-end; /* Addizioni/Sottrazioni a destra */
}

/* Colore Rosso per Negativi (simbolo e valore) */
.tape-row.negative .tape-val,
.tape-row.negative .tape-symbol {
    color: var(--tape-negative-color, #cc0000);
}

/* Editable tape entries */
.tape-editable {
    cursor: pointer;
}
.tape-editable:hover {
    text-decoration: underline dotted;
}
.tape-edit-input {
    width: 80%;
    max-width: 10ch;
    font-family: inherit;
    font-size: inherit;
    background: transparent;
    border: none;
    border-bottom: 1px dashed currentColor;
    color: inherit;
    text-align: right;
    outline: none;
    padding: 0;
}

/* Result Row Separation */
.tape-row.result-row {
    margin-bottom: 15px; /* Spazio extra dopo il risultato */
    border-bottom: 2px solid rgba(0,0,0,0.1); /* Linea di chiusura blocco */
    padding-bottom: 2px;
}
.tape-row.result-row .tape-symbol {
    font-size: 0.8em; /* Simbolo più evidente */
    color: var(--tape-result-text, #444);
}

.tape-row.result-row .tape-symbol.tape-symbol-small {
    font-size: 0.8em;
    min-width: 12px;
}
/* --- History Snapshots --- */
.calc-history-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    padding: 0;
    flex-shrink: 0;
    background: var(--history-container-bg, #272f47);
    border-radius: 6px;
    grid-column: 1 / -1;
    gap: 6px;
    padding: 8px;
}

.calc-history-controls {
    display: flex;
    gap: 8px;
    width: 100%;
}

.calc-save-btn,
.calc-load-btn {
    flex: 1;
    padding: 6px 10px;
    font-size: 0.85em;
    font-family: "Inter", sans-serif;
    font-weight: 600;
    border: 1px solid #555;
    border-radius: 3px;
    background: #3a4556;
    color: #e6e4d5;
    cursor: pointer;
    transition: all 0.15s ease;
}

.calc-save-btn:hover,
.calc-load-btn:hover {
    background: #4a5566;
    border-color: #777;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

.calc-save-btn:active,
.calc-load-btn:active {
    transform: translateY(1px);
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
}

.calc-history-icons {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 4px 0;
    width: 100%;
    max-height: 80px;
    overflow-y: auto;
    overflow-x: auto;
}

.calc-history-icon {
    padding: 3px 6px;
    font-size: 0.65em;
    font-family: "Droid Sans Mono", monospace;
    background: #5674a0;
    border: 1px solid #888;
    border-radius: 2px;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.12s ease;
    flex-shrink: 0;
    position: relative;
}

.calc-history-icon:hover {
    background: #c0c0c0;
    border-color: #555;
    box-shadow: 0 1px 3px rgba(0,0,0,0.15);
    transform: translateY(-0.5px);
}

.calc-history-icon:hover::before {
    content: none;
}

/* Stile Tooltip (creato dinamicamente da JS) */
.calc-history-tooltip {
    position: fixed;
    background: #2a2a2a;
    color: #f0f0f0;
    padding: 6px 8px;
    border-radius: 3px;
    font-size: 0.75em;
    white-space: pre-wrap;
    word-wrap: break-word;
    max-width: 200px;
    z-index: 10000;
    pointer-events: none;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    border: 1px solid #555;
    text-align: left;
    font-family: "Droid Sans Mono", monospace;
    animation: tooltipFadeIn 0.15s ease-in-out;
}

@keyframes tooltipFadeIn {
    from {
        opacity: 0;
        transform: translateY(4px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* --- Save/Load Dialogs --- */
.calc-dialog-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5000;
    animation: fadeIn 0.2s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.calc-dialog {
    background: #556887;
    border: 2px solid #3a3a3a;
    border-radius: 6px;
    padding: 20px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    max-width: 400px;
    min-width: 300px;
    color: #e6e4d5;
    font-family: "Inter", sans-serif;
}

.calc-dialog-header {
    margin-bottom: 16px;
}

.calc-dialog-header h3 {
    margin: 0;
    font-size: 1.1em;
    color: #e6e4d5;
}

.calc-dialog-content {
    margin-bottom: 16px;
}

.calc-dialog-input {
    width: 100%;
    padding: 8px;
    border: 1px solid #777;
    border-radius: 3px;
    background: #3a4556;
    color: #e6e4d5;
    font-family: "Inter", sans-serif;
    font-size: 0.95em;
    box-sizing: border-box;
}

.calc-dialog-input:focus {
    outline: none;
    border-color: #89cff0;
    box-shadow: 0 0 4px rgba(137, 207, 240, 0.3);
}

.calc-dialog-input::placeholder {
    color: #888;
}

.calc-dialog-list {
    border: 1px solid #777;
    border-radius: 3px;
    background: #3a4556;
    max-height: 300px;
    overflow-y: auto;
}

.calc-dialog-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 12px;
    border-bottom: 1px solid #454d5a;
    cursor: pointer;
    transition: background 0.1s ease;
}

.calc-dialog-list-item:last-child {
    border-bottom: none;
}

.calc-dialog-list-item:hover {
    background: #454d5a;
}

.calc-dialog-list-item-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.calc-dialog-list-item-name {
    font-weight: 600;
    color: #e6e4d5;
    font-size: 0.95em;
}

.calc-dialog-list-item-meta {
    font-size: 0.8em;
    color: #999;
}

.calc-dialog-list-item-delete {
    background: #d64545;
    border: none;
    color: #fff;
    border-radius: 2px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 0.85em;
    font-weight: 600;
    margin-left: 8px;
    transition: background 0.15s ease;
}

.calc-dialog-list-item-delete:hover {
    background: #e85555;
}

.calc-dialog-list-item-delete:active {
    transform: scale(0.95);
}

.calc-dialog-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    flex-wrap: wrap;
}

.calc-dialog-btn {
    padding: 8px 16px;
    border: 1px solid #555;
    border-radius: 3px;
    background: #3a4556;
    color: #e6e4d5;
    font-family: "Inter", sans-serif;
    font-size: 0.95em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
}

.calc-dialog-btn:hover {
    background: #4a5566;
    border-color: #777;
}

.calc-dialog-btn:active {
    transform: translateY(1px);
}

.calc-dialog-btn.primary {
    background: #5f8a9e;
    border-color: #3a6a8a;
}

.calc-dialog-btn.primary:hover {
    background: #6f9aae;
}

.calc-dialog-btn.danger {
    background: #d64545;
    border-color: #b03535;
}

.calc-dialog-btn.danger:hover {
    background: #e85555;
}

.calc-dialog-error {
    color: #ff7777;
    font-size: 0.85em;
    margin-top: 8px;
}

.calc-history-icon:active {
    transform: translateY(0);
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
}